<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>D·ª± b√°o bit 0-1</title>

<style>
body {
    font-family: Consolas, monospace;
    background: #020617;
    color: #e5e7eb;
    display: flex;
    justify-content: center;   /* v·∫´n cƒÉn gi·ªØa ngang */
    align-items: flex-start;   /* s√°t m√©p tr√™n */
    
    height: 100vh;
    margin: 20px;
}

.container {
    background: #0f172a;
    padding: 40px;
    border-radius: 16px;
    box-shadow: 0 0 30px rgba(0,0,0,0.6);
    text-align: center;
    min-width: 600px;
     border: 1px solid #334155;
}

h3 {
    margin-bottom: 12px;
}

#inputs {
    display: flex;
    gap: 8px;
    margin-bottom: 10px;
}

input.bit {
    width: 48px;
    height: 56px;
    text-align: center;
    font-size: 26px;
    background: #020617;
    color: #e5e7eb;
    border: 2px solid #334155;
    border-radius: 8px;
    outline: none;
    transition: 0.15s;
}

input.bit:focus {
    border-color: #22c55e;
    box-shadow: 0 0 0 2px rgba(34,197,94,0.3);
}

button {
    padding: 10px 18px;
    background: #16a34a;
    border: none;
    border-radius: 8px;
    color: white;
    font-size: 16px;
    cursor: pointer;
}

button:hover {
    background: #22c55e;
}

#result {
    margin-top: 1px;
    font-size: 26px;
    font-weight: bold;
    letter-spacing: 1px;
    text-align: center;
    
    color: #22c55e;
    
    background: linear-gradient(135deg, #0f172a, #1e293b);
    padding: 15px 25px;
    border-radius: 12px;
    
    border: 1px solid #334155;
    
    box-shadow:
        0 0 10px rgba(34,197,94,0.4),
        0 0 25px rgba(34,197,94,0.2),
        inset 0 0 10px rgba(34,197,94,0.1);

    transition: all 0.3s ease;
}

#result.active {
    animation: glow 0.6s ease;
}

@keyframes glow {
    0% {
        transform: scale(0.95);
        opacity: 0;
    }
    100% {
        transform: scale(1);
        opacity: 1;
    }
}
#fileInput,
button {
    display: none;
}


.button1 {
    padding: 15px 20px;
    background: #16a34a;
    border: none;
    border-radius: 10px;
    color: white;
    font-size: 30px;
    cursor: pointer;
    transition: 0.2s ease;
    margin: 20px auto;
    display: block;
    width: fit-content;
}

.button1:hover {
    background: #22c55e;
    transform: translateY(-2px);
    box-shadow: 0 8px 18px rgba(34,197,94,0.3);
}

.button1:active {
    transform: scale(0.96);
}

</style>
</head>

<body>

<div class="container">
   
    <h3>7- 00111</h3>
    <h3> 6 - 11000</h3>
    <h3>5 - 11111</h3>
    <h3> 0 -  **000</h3>
    <h3>34,43,04,40 --   **111</h3>
    <h3>9 - **000</h3>
    <h3>Nh·∫≠p 10 bit (0 / 1)</h3>
    
    

    <div id="inputs"></div>

    <input type="file" id="fileInput">
    <br><br>

    <button type="button" onclick="predict()">T√≠nh bit ti·∫øp theo</button>

    <div id="result"></div>
    <div class="button1" onclick="resetAll()">Reset</div>

</div>

<script>
const inputsDiv = document.getElementById("inputs");
let inputCount = 0;



// t·∫°o 11 √¥
for (let i = 0; i < 11; i++) {
    const inp = document.createElement("input");
    inp.className = "bit";
    inp.maxLength = 1;

    if (i < 10) {
        inp.readOnly = true; // 10 √¥ hi·ªÉn th·ªã
    } else {
        // √¥ th·ª© 11 ƒë·ªÉ nh·∫≠p
        inp.addEventListener("input", function () {
            const v = this.value;

            if (v !== "0" && v !== "1") {
                this.value = "";
                return;
            }

            const inputs = inputsDiv.querySelectorAll("input");

            // 10 l·∫ßn ƒë·∫ßu: ch·ªâ ƒëi·ªÅn t·ª´ tr√°i sang ph·∫£i
            if (inputCount < 10) {
                inputs[inputCount].value = v;
                inputCount++;
            } 
            // t·ª´ l·∫ßn 11 tr·ªü ƒëi: shift + predict
            else {
                shiftLeft(v);
                predict();
            }

            this.value = "";
        });
    }

    inputsDiv.appendChild(inp);
}


// ===== D·ªäCH TR√ÅI =====
function shiftLeft(newBit) {
    const inputs = inputsDiv.querySelectorAll("input");

    for (let i = 0; i < 9; i++) {
        inputs[i].value = inputs[i + 1].value;
    }

    inputs[9].value = newBit;
}


let historyBits = "";

document.getElementById("fileInput").addEventListener("change", e => {
    const file = e.target.files[0];
    const reader = new FileReader();
    reader.onload = () => {
        historyBits = reader.result.replace(/[^01]/g, "");
        alert("ƒê√£ n·∫°p " + historyBits.length + " bit");
    };
    reader.readAsText(file);
});



function predict() {
    if (historyBits.length < 11) {
        alert("Ch∆∞a c√≥ d·ªØ li·ªáu l·ªãch s·ª≠");
        return;
    }

    const inputs = [...inputsDiv.querySelectorAll("input")]
    .slice(0, 10)
    .map(i => i.value)
    .join("");

    if (inputs.length < 10) {
        alert("Ch∆∞a nh·∫≠p ƒë·ªß 10 bit");
        return;
    }

    let count0 = 0;
    let count1 = 0;

    for (let i = 0; i <= historyBits.length - 11; i++) {
        if (historyBits.substr(i, 10) === inputs) {
            const nextBit = historyBits[i + 10];
            if (nextBit === "0") count0++;
            else count1++;
        }
    }

    let text;
    if (count0 === 0 && count1 === 0) {
        text = "Kh√¥ng c√≥ m·∫´u tr√πng trong l·ªãch s·ª≠";
    } else if (count1 > count0) {
        text = `‚Üí ƒê·ªÅ xu·∫•t: 1  (1:${count1} | 0:${count0})`;
    } else {
        text = `‚Üí ƒê·ªÅ xu·∫•t: 0  (0:${count0} | 1:${count1})`;
    }

    document.getElementById("result").innerText = text;

// üî• focus l·∫°i √¥ 11
    const inputsAll = inputsDiv.querySelectorAll("input");
    inputsAll[10].focus();
}

const resultDiv = document.getElementById("result");
resultDiv.classList.remove("active");
void resultDiv.offsetWidth; 
resultDiv.classList.add("active");



   const DEFAULT_FILE_URL =
"    https://tomato-delicate-zebra-533.mypinata.cloud/ipfs/bafybeih3p2hg63ysjgg6zitazpp6p3fcadv2lqm2fvwlhjnrzhosiiwnka";

function loadDefault() {
    fetch(DEFAULT_FILE_URL)
        .then(response => {
            if (!response.ok) throw new Error("Kh√¥ng t·∫£i ƒë∆∞·ª£c IPFS");
            return response.text();
        })
        .then(text => {
            historyBits = text.replace(/[^01]/g, "");
            console.log("ƒê√£ n·∫°p m·∫∑c ƒë·ªãnh:", historyBits.length, "bit");
        })
        .catch(err => {
            console.error("L·ªói load IPFS:", err);
        });
}


function resetAll() {
    const inputs = inputsDiv.querySelectorAll("input");

    // X√≥a 10 √¥ hi·ªÉn th·ªã
    for (let i = 0; i < 10; i++) {
        inputs[i].value = "";
    }

    // X√≥a k·∫øt qu·∫£
    document.getElementById("result").innerText = "";

    // Focus l·∫°i √¥ 11
    inputs[10].focus();
}



// G·ªçi t·ª± ƒë·ªông khi trang load
window.addEventListener("load", () => {
    const inputs = inputsDiv.querySelectorAll("input");
    inputs[10].focus(); // focus √¥ th·ª© 11
});
 loadDefault();

</script>
</body>
</html>






